(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/bookingManagement/bookingManagement"],{"0bad":function(t,e,o){"use strict";var n=o("54b2"),i=o.n(n);i.a},"54b2":function(t,e,o){},"6aba":function(t,e,o){"use strict";o.r(e);var n=o("d6c6"),i=o("dd1f");for(var s in i)"default"!==s&&function(t){o.d(e,t,(function(){return i[t]}))}(s);o("0bad");var u,r=o("f0c5"),a=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],u);e["default"]=a.exports},a088:function(t,e,o){"use strict";(function(t){o("2cfb");n(o("66fd"));var e=n(o("6aba"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},d6c6:function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return s})),o.d(e,"a",(function(){return n}));var n={uSearch:function(){return o.e("uview-ui/components/u-search/u-search").then(o.bind(null,"143d"))},uImage:function(){return o.e("uview-ui/components/u-image/u-image").then(o.bind(null,"0e5c"))},topNav:function(){return o.e("components/top-nav/top-nav").then(o.bind(null,"5f09"))},uPopup:function(){return o.e("uview-ui/components/u-popup/u-popup").then(o.bind(null,"089a"))},card:function(){return o.e("components/card/card").then(o.bind(null,"bc44"))},uRow:function(){return o.e("uview-ui/components/u-row/u-row").then(o.bind(null,"5fa6"))},uCol:function(){return o.e("uview-ui/components/u-col/u-col").then(o.bind(null,"5d8b"))},uIcon:function(){return o.e("uview-ui/components/u-icon/u-icon").then(o.bind(null,"0922"))},uLine:function(){return o.e("uview-ui/components/u-line/u-line").then(o.bind(null,"2cae"))},formList:function(){return o.e("components/form-list/form-list").then(o.bind(null,"9a28"))},uGap:function(){return o.e("uview-ui/components/u-gap/u-gap").then(o.bind(null,"3be9"))},goodList:function(){return o.e("components/good-list/good-list").then(o.bind(null,"a545"))},uTag:function(){return o.e("uview-ui/components/u-tag/u-tag").then(o.bind(null,"5cea"))},uCheckbox:function(){return o.e("uview-ui/components/u-checkbox/u-checkbox").then(o.bind(null,"0bdf"))},uButton:function(){return o.e("uview-ui/components/u-button/u-button").then(o.bind(null,"4d2a"))},uEmpty:function(){return o.e("uview-ui/components/u-empty/u-empty").then(o.bind(null,"6c67"))},uLoadmore:function(){return o.e("uview-ui/components/u-loadmore/u-loadmore").then(o.bind(null,"d4ea"))},uMask:function(){return o.e("uview-ui/components/u-mask/u-mask").then(o.bind(null,"001e"))},uToast:function(){return o.e("uview-ui/components/u-toast/u-toast").then(o.bind(null,"1922"))}},i=function(){var t=this,e=t.$createElement,o=(t._self._c,t.__map(t.popupList,(function(e,o){var n=t.__get_orig(e),i=t.__map(e.list,(function(o,n){var i=t.__get_orig(o),s=t.judge(e.selected,o.id);return{$orig:i,m0:s}}));return{$orig:n,l0:i}})));t._isMounted||(t.e0=function(e){t.show=!0}),t.$mp.data=Object.assign({},{$root:{l1:o}})},s=[]},dbb4:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){o.e("components/good-list/good-list").then(function(){return resolve(o("a545"))}.bind(null,o)).catch(o.oe)},i=function(){o.e("components/top-nav/top-nav").then(function(){return resolve(o("5f09"))}.bind(null,o)).catch(o.oe)},s=function(){o.e("components/card/card").then(function(){return resolve(o("bc44"))}.bind(null,o)).catch(o.oe)},u=function(){o.e("components/form-list/form-list").then(function(){return resolve(o("9a28"))}.bind(null,o)).catch(o.oe)},r={components:{goodList:n,topNav:i,card:s,formList:u},onLoad:function(){this.scrollHeight=this.$u.sys().windowHeight-t.upx2px(300),this.getScreenData(),this.getInfo()},onShow:function(){var e=this;t.$on("chooseCustomer",(function(o){e.fromList[0].value=o.item.name,e.fromList[0].id=o.item.id,t.$off("chooseCustomer")})),t.$on("chooseSeller",(function(o){e.fromList[1].value=o.item.name,e.fromList[1].id=o.item.id,t.$off("chooseSeller")})),t.$on("back",(function(o){setTimeout((function(){e.clearGoodList()}),2e3),t.$off("back")}))},beforeDestroy:function(){t.$off("chooseCustomer"),t.$off("chooseSeller"),t.$off("back")},computed:{isShowTab:function(){return 0!==this.book_order_ids.length},checkedAll:{get:function(){return this.goodList.every((function(t){return!0===t.checked}))},set:function(t){}},showCheckAll:function(){return""!=this.fromList[0].id}},onPullDownRefresh:function(){this.clearGoodList()},data:function(){return{scrollHeight:0,customer_id:"",book_order_ids:[],keyword:"",navList:[{label:"定金金额",number:0,unit:"元",url:"",isNav:!1,decimals:2},{label:"件数",number:0,unit:"件",url:"t",isNav:!1,decimals:0},{label:"人数",number:0,unit:"个",url:"",isNav:!1,decimals:0},{label:"商品数",number:0,unit:"种",url:"",isNav:!1,decimals:0}],screen:{currentIndex:0,list:[{name:"待开单",status:0},{name:"已开单",status:1}]},show:!1,popupList:[{name:"品牌",selected:"",isBrand:!0,list:[]},{name:"一级分类",selected:"",isBrand:!1,list:[]},{name:"二级分类",selected:"",isBrand:!1,list:[]}],fromList:[{type:"picker",name:"相关客户",value:"",id:"",url:"/pages/home/salesBilling/customerList/customerList",isImport:!1},{type:"picker",name:"销售员",value:"",id:"",url:"/pages/home/bookingManagement/Employees/Employees",isImport:!1}],page:1,last_page:1,goodList:[],status:"loading",iconType:"flower",loadText:{loadmore:"轻轻上拉",loading:"努力加载中",nomore:"实在没有了"}}},methods:{getScreenData:function(){var t=this;this.http.get("/api/v1/BookOrder/getBookScreenData",{},!0).then((function(e){1e3==e.code&&(t.popupList[0].list=e.data.brand,t.popupList[1].list=e.data.top_cate)}))},getScreenCate:function(t){var e=this;this.http.get("/api/v1/Index/getScreenCate",{top_cate_id:t},!0).then((function(t){1e3==t.code&&(e.popupList[2].list=t.data.cate)}))},getInfo:function(){var t=this;this.http.get("/api/v1/BookOrder/bookOrderLogs",{keyword:this.keyword,status:this.screen.currentIndex,brand_id:this.popupList[0].selected.toString()||0,top_cate_id:this.popupList[1].selected.toString()||0,cate_id:this.popupList[2].selected.toString(),customer_id:this.fromList[0].id,seller_id:this.fromList[1].id,page:this.page},!0).then((function(e){1e3==e.code&&(0==t.goodList.length?(t.goodList=e.data.main.book_data||[],t.last_page=e.data.main.last_page||1,t.navList[0].number=e.data.top.total_price.value,t.navList[1].number=e.data.top.book_num,t.navList[2].number=e.data.top.book_cus_num,t.navList[3].number=e.data.top.book_good_num,t.navList[0].unit=e.data.top.total_price.unit):e.data.main.book_data.map((function(e){t.goodList.push(e)})),t.goodList.map((function(e){e.hasOwnProperty("checked")||t.$set(e,"checked",!1)})),console.log(t.goodList),t.page>=t.last_page?t.status="nomore":t.status="loadmore",t.show=!1)}))},scrolltolower:function(){var t=this;this.page>=this.last_page||(this.status="loading",this.page=++this.page,setTimeout((function(){t.getInfo()}),50))},clearGoodList:function(){this.show=!1,this.page=1,this.last_page=1,this.goodList=[],this.status="loading",this.book_order_ids=[],this.customer_id="",this.getInfo(),t.stopPullDownRefresh()},changeScreen:function(t){this.screen.currentIndex=t.status,this.clearGoodList()},judge:function(t,e){return t===e},choose:function(t,e,o){1==o&&t.selected!=e.id?this.getScreenCate(e.id):1==o&&t.selected==e.id&&(this.popupList[2].list=[],this.popupList[2].selected=""),t.selected==e.id?t.selected="":this.$set(t,"selected",e.id)},reset:function(){this.show=!1,this.popupList.forEach((function(t){t.selected=""})),this.fromList.forEach((function(t){t.value="",t.id=""})),this.clearGoodList()},cancel:function(t){var e=this;this.http.modal("警告","是否取消此预定？",!0,(function(o){o&&e.http.get("/api/v1/BookOrder/cancelBook",{book_order_id:t}).then((function(t){1e3==t.code?(e.$refs.uToast.show({title:t.msg,type:"success"}),e.clearGoodList()):e.$refs.uToast.show({title:t.msg,type:"error"})}))}),"#FE8702")},bookAll:function(t){if(t.value){var e=[];this.goodList.forEach((function(t){t.checked=!0,e.push(t.id)})),this.book_order_ids=e}else this.goodList.forEach((function(t){t.checked=!1})),this.book_order_ids=[]},book:function(t,e,o){var n=this;if(this.customer_id||(this.customer_id=e.customer_id),t.value&&e.customer_id===this.customer_id)this.book_order_ids.push(e.id);else if(t.value||e.customer_id!==this.customer_id)t.value&&e.customer_id!=this.customer_id&&(setTimeout((function(){n.$set(e,"checked",!1),console.log("settimeout")}),50),this.$refs.uToast.show({title:"请选择同一客户的预订单！",type:"error"}));else{var i=this.book_order_ids.indexOf(e.id);this.book_order_ids.splice(i,1)}0==this.book_order_ids.length&&(this.customer_id="")},bookOrders:function(){var e=this;this.http.modal("警告","前往开单后，这些预定记录将立即更改为已开单，是否前往？",!0,(function(o){o&&t.navigateTo({url:"/pages/home/salesBilling/salesBilling?book_order_ids="+JSON.stringify(e.book_order_ids)})}),"#FE8702")},open:function(e){this.http.modal("警告","前往开单后，此预定记录将立即更改为已开单，是否前往？",!0,(function(o){o&&t.navigateTo({url:"/pages/home/salesBilling/salesBilling?book_order_ids="+JSON.stringify([e])})}),"#FE8702")}}};e.default=r}).call(this,o("543d")["default"])},dd1f:function(t,e,o){"use strict";o.r(e);var n=o("dbb4"),i=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a}},[["a088","common/runtime","common/vendor"]]]);